{% extends 'eduquiz/base.html' %}
{% load staticfiles %}

{% block head %}
  <link rel="stylesheet" type="text/css" href="{% static "eduquiz/css/header.css" %}">
  <link rel="stylesheet" type="text/css" href="{% static "quiz/css/multipleChoiceQuestion.css" %}">
{% endblock head %}

{% block header %}

  {% include 'eduquiz/header.html' %}

{% endblock header %}

{% block content %}

  <div class="quiz">
    <div class="ui piled segment question" question="{{ question.id }}">
        <h4 class="info stuff">
        <i class="flag icon report button" id="report-flag"></i>
          {{ question.topic }} - {{ question.topic.subject.code }}<br>
        </h4>

        <div style="height: 70px;"></div>

        <div style="position: relative;">

          <div class="ui questionText">
            {{ question }}
          </div>

          {% for answer in answers %}
            <div class="ui secondary segment answer" answer="{{ answer.0 }}">
              <div class="content">
            {{ answer.1 }}
        </div>
      </div>
    {% endfor %}
  </div>
</div>


    <style>
      #report-flag {
        float: left;
      }
    </style>

    <script>
      var answered = false;

      $('.answer').click(function() {
        if (!answered) {
          answered = true;

          $.ajaxSetup({
              beforeSend: function(xhr, settings) {
                  xhr.setRequestHeader("X-CSRFToken", '{{ csrf_token }}');
              }
          });

          $.ajax({
            type: "POST",
            url: '',
            data: {
              'question': $('.question').attr('question'),
              'answer': $(this).attr('answer'),
            },
            success: function(data) {

              var answer = data['answer'];
              var correct = data['correct'];

              $('.answer[answer=' + answer + ']').css('background-color', '#EF5350');
              $('.answer[answer=' + correct + ']').css('background-color', '#66BB6A');

              setTimeout(function() {
                location.reload();
              }, 500);
            }
          });
        }
      });
    </script>
  <div>

{% endblock content %}
